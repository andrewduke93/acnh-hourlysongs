<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACNH Hourly Music ðŸŽ¶</title>
    <style>
        /* Your existing CSS styles remain unchanged */
    </style>
</head>
<body>
    <h1>ðŸŒ¸ ACNH Hourly Music ðŸŒ¼</h1>

    <div id="videoContainer">
        <div id="player"></div>
    </div>

    <div id="countdown">Time until next video: 00:00</div>
    <div id="nextUp">Next Up: Loading...</div>

    <script>
        const videoUrls = [
            // Your existing video URLs
        ];

        const videoTitles = [
            "Animal Crossing Music 12 AM", 
            "Animal Crossing Music 1 AM",  
            "Animal Crossing Music 2 AM",
            "Animal Crossing Music 3 AM",
            "Animal Crossing Music 4 AM",
            "Animal Crossing Music 5 AM",
            "Animal Crossing Music 6 AM",
            "Animal Crossing Music 7 AM",
            "Animal Crossing Music 8 AM",
            "Animal Crossing Music 9 AM",
            "Animal Crossing Music 10 AM",
            "Animal Crossing Music 11 AM",
            "Animal Crossing Music 12 PM",
            "Animal Crossing Music 1 PM",
            "Animal Crossing Music 2 PM",
            "Animal Crossing Music 3 PM",
            "Animal Crossing Music 4 PM",
            "Animal Crossing Music 5 PM",
            "Animal Crossing Music 6 PM",
            "Animal Crossing Music 7 PM",
            "Animal Crossing Music 8 PM",
            "Animal Crossing Music 9 PM",
            "Animal Crossing Music 10 PM",
            "Animal Crossing Music 11 PM"
        ];

        let player;
        let countdownInterval;

        function newPlayer(videoId) {
            if (player) { player.destroy(); }
            player = new YT.Player('player', {
                height: '200',
                width: '100%',
                videoId: videoId,
                playerVars: {
                    'autoplay': 1, // Enable autoplay
                    'playlist': videoId,
                    'loop': 1,
                    'start': 0,
                    'controls': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onYouTubeIframeAPIReady() {
            newPlayer(getVideoId());
            updateNextUp(); 
            refreshOnHour();
        }

        function onPlayerReady(event) {
            event.target.playVideo();
            setCountdown();
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.ENDED) {
                switchToNextVideo();
            }
        }

        function switchToNextVideo() {
            newPlayer(getVideoId());
            setCountdown();
            updateNextUp();
        }

        function getVideoId() {
            return videoUrls[new Date().getHours() % videoUrls.length].split('v=')[1];
        }

        function setCountdown() {
            clearInterval(countdownInterval);
            let seconds = getSecondsUntilNextHour();
            updateCountdownDisplay(seconds);

            countdownInterval = setInterval(() => {
                seconds--;
                updateCountdownDisplay(seconds);

                if (seconds <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
        }

        function updateCountdownDisplay(seconds) {
            const countdownElement = document.getElementById('countdown');
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            countdownElement.textContent = `Time until next video: ${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        function getSecondsUntilNextHour() {
            const now = new Date();
            return 3600 - now.getMinutes() * 60 - now.getSeconds();
        }

        function updateNextUp() {
            const nextUpElement = document.getElementById('nextUp');
            const nextHour = (new Date().getHours() + 1) % 24;
            nextUpElement.textContent = `Next Up: ${videoTitles[nextHour]}`;
        }

        function refreshOnHour() {
            let secondsUntilNextHour = getSecondsUntilNextHour();
            setTimeout(() => {
                location.reload();
            }, secondsUntilNextHour * 1000);
        }

        // Load the YouTube API script
        const tag = document.createElement('script');
        tag.src = 'https://www.youtube.com/iframe_api';
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    </script>
</body>
</html>
